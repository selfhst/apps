<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
  <id>https://selfh.st/apps</id>
  <title>Medusa Releases</title>
  <updated>2025-06-09T21:31:11.810885-04:00</updated>
  <author>
    <name>selfh.st</name>
    <email>contact@selfh.st</email>
  </author>
  <link href="https://selfh.st/apps" rel="alternate"/>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <subtitle>Self-hosted software releases generated by selfh.st</subtitle>
  <entry>
    <id>https://github.com/medusajs/medusa/releases/tag/v2.8.0</id>
    <title>New release for Medusa: v2.8.0</title>
    <updated>2025-05-13T07:10:07-04:00</updated>
    <author>
      <name>medusajs/medusa</name>
    </author>
    <content>&lt;!-- 
![2-8-0](https://gh-release-images.s3.eu-north-1.amazonaws.com/v2.8.0.png)

# v2.8.0: More robust cart-completion, cross-module filtering, and Tax Providers

This release improves the robustness of the cart-completion workflow, enables cross-module filtering via a new module, and introduces full support for custom Tax Providers.

CMS_BREAK --&gt;

&lt;h2&gt;Highlights&lt;/h2&gt;
&lt;h3&gt;Important: This release introduced a regression with product updates&lt;/h3&gt;
&lt;p&gt;We unintentionally introduced a regression that affected the ordering of products returned from the product module service. This broke workflows (e.g. updateProductsWorkflow) that rely on consistent ordering for subsequent operations such as applying price updates. &lt;/p&gt;
&lt;p&gt;Upgrade to v2.8.1 as soon as possible to avoid any issues related to this change.&lt;/p&gt;
&lt;h3&gt;Cart-completion robustness&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;[!WARNING]&lt;br /&gt;
Breaking changes&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This release introduces important changes to the &lt;code&gt;completeCartWorkflow&lt;/code&gt; aimed at improving robustness and making it easier to recover from failures. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Changes to idempotency&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Until now, the workflow has had the following configuration:
&lt;code&gt;ts
{
  name: completeCartWorkflowId
  store: true,
  idempotent: true,
  retentionTime: THREE_DAYS,
}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Here's a brief description of what these properties do, excluding &lt;code&gt;name&lt;/code&gt;:
- &lt;code&gt;store&lt;/code&gt;: Store the workflow execution. If no retention time is specified, the workflow is only stored for the duration of its execution
- &lt;code&gt;idempotent&lt;/code&gt;: Store the result of the &lt;em&gt;first&lt;/em&gt; workflow execution and return it on subsequent runs
- &lt;code&gt;retentionTime&lt;/code&gt;: Store the result in the configured data store for "x" amount of time–here, three days&lt;/p&gt;
&lt;p&gt;In this release, we change the &lt;code&gt;idempotent&lt;/code&gt; flag from true to false. Initially, the idea of having an idempotent cart-completion stemmed from wanting to ensure that multiple requests to complete the same cart would lead to the same outcome. This is, in of itself, still reasonable to ensure there is only ever one attempt to complete the same cart. However, in case of failures, the idempotent mechanism makes it challenging to recover, since a new cart with the same details is required to re-attempt the completion. This is because the result of the failing workflow is stored and returned on all subsequent runs, regardless of whether the cart is updated to satisfy the constraints for completion.&lt;/p&gt;
&lt;p&gt;With &lt;code&gt;idempotent&lt;/code&gt; set to false, it will be possible to retry failed executions, making it simpler to bring the cart to a satisfying state and eventually create the order.&lt;/p&gt;
&lt;p&gt;It is worth mentioning that concurrency continues to be appropriately managed by passing the cart ID as the &lt;code&gt;transactionId&lt;/code&gt; when running the workflow. The transaction ID ensures that only one workflow execution can run at a time.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Changes to the structure&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The workflow has been slightly restructured to minimize the risk of payment sessions getting stuck in a state that is difficult to recover from. More specifically, the payment authorization step has been moved to the very end of the workflow, so that all first-party checks are performed before we authorize the payment. &lt;/p&gt;
&lt;p&gt;To understand why this is important, we need to cover the &lt;code&gt;compensateIfNeeded&lt;/code&gt; step of the workflow briefly. This step compensates active payment sessions in the case of failure to avoid orphaned third-party payments and recreates the Medusa payment session so that new payment details can be attached.&lt;/p&gt;
&lt;p&gt;For example, suppose the payment authorization is performed off-band (e.g., in a webhook), and the cart-completion workflow fails to execute. In that case, the step will void the third-party payment and bring the cart to a correct state, all while ensuring consistency between the two systems. &lt;/p&gt;
&lt;p&gt;Moving the payment authorization step to the end of the workflow ensures that we only create an authorized payment if all other cart constraints are satisfied. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Changes to the webhook handler&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The webhook handler ensures consistency between Medusa and the third-party payment provider. More specifically, it will handle the following scenarios:
- Payment authorization: when we receive a payment authorization event, we will attempt to authorize and create a payment in Medusa
- Payment capture: when we receive a payment capture event, we will attempt to capture the associated payment in Medusa
- Cart-completion: when we receive a payment authorization event, we will attempt to complete the cart
- Payment authorization and capture: when we receive a payment capture event and there is no existing payment in Medusa, we will attempt to authorize, create, and capture a payment in Medusa&lt;/p&gt;
&lt;p&gt;We have only handled the first three scenarios until now. This release introduces functionality for the fourth, a more unusual scenario involving auto-captures in the third-party payment provider.&lt;/p&gt;
&lt;h3&gt;Line item generation&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;[!WARNING]&lt;br /&gt;
Breaking changes&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This release changes the source of line item titles and subtitles. The title has changed from the variant title to the product title, and the subtitle has changed from the product title to the variant title.&lt;/p&gt;
&lt;h3&gt;Cross-module filters (experimental)&lt;/h3&gt;
&lt;p&gt;This release introduces experimental support for cross-module filters via a new module, &lt;code&gt;@medusajs/index&lt;/code&gt;. &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Please remember that this module is experimental and in development, so please use it cautiously. It is subject to change as we finalize the design to enable cross-module filtering. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We will keep the description brief since the module is still in development. Here's what you need to know:
- Medusa's architecture is divided into a range of modules, each being isolated (at the data model level) from one another. By default, the modules share the same database, but the architecture is built to support external data sources, in case your module needs a different type of database, or you want to use a third-party service in place of Medusa's core module
- Consequently, queries to retrieve data are performed per module, and the data is aggregated in the end to create the result set
- Our new index module allows you to ingest data into a central, relational-like structure
- The structure enables efficient filtering over data coming from different data sources (provided it is ingested)&lt;/p&gt;
&lt;p&gt;The index module can be enabled by installing the module:
&lt;code&gt;yarn add @medusajs/index&lt;/code&gt;
Adding it to your Medusa config:
&lt;code&gt;{
  // ...rest of config
  modules: [{ resolve: "@medusajs/index", options: {} }]
}&lt;/code&gt;
And finally, adding a feature flag to enable it:
&lt;code&gt;// .env
MEDUSA_FF_INDEX_ENGINE=true&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Then, apply the migrations to create the related tables:
&lt;code&gt;npx medusa db:migrate&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The next time you start your server, we will ingest data into the index engine. &lt;/p&gt;
&lt;p&gt;In this first iteration, we only ingest the following core entities:
- Products
- Product Variants
- Prices
- Sales Channels&lt;/p&gt;
&lt;p&gt;The data in the index is queried through a new API with semantics identical to the existing query graph:
&lt;code&gt;ts
  const { data: products = [], metadata } = await query.index({
    entity: "product",
    fields: ["id", "name"],
  });&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;In addition to ingesting a few select resources from the core, we have added support for ingesting data from custom modules through link definitions. For example, say you want to introduce a Brand on Products and filter your Products by it.&lt;/p&gt;
&lt;p&gt;Assuming you have added a Brand module, you create a link as follows:
```ts
import { defineLink } from "@medusajs/framework/utils";
import ProductModule from "@medusajs/medusa/product";
import BrandModule from "../modules/brand";&lt;/p&gt;
&lt;p&gt;export default defineLink(
  {
    linkable: ProductModule.linkable.product,
    isList: true,
  },
  {
    linkable: BrandModule.linkable.brand,
  }
);
```&lt;/p&gt;
&lt;p&gt;This link will associate the two data models and allow you to query them from both sides of the link. &lt;/p&gt;
&lt;p&gt;Furthermore, to ingest the Brand into the index and make the data filterable, you need to add the new &lt;code&gt;filterable&lt;/code&gt; property to the link:
```ts
import { defineLink } from "@medusajs/framework/utils";
import ProductModule from "@medusajs/medusa/product";
import BrandModule from "../modules/brand";&lt;/p&gt;
&lt;p&gt;export default defineLink(
  {
    linkable: ProductModule.linkable.product,
    isList: true,
  },
  {
    linkable: BrandModule.linkable.brand,
    filterable: ["id", "name"]
  }
);
```&lt;/p&gt;
&lt;p&gt;The link above specifies that Brands should be ingested into the index and made filterable via the properties &lt;code&gt;id&lt;/code&gt; and &lt;code&gt;title&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;As a result, you can now filter Products by Brands ID or title like so:
&lt;code&gt;ts
  const { data: products = [], metadata } = await query.index({
    entity: "product",
    fields: ["id", "title", "brand.*"],
    filters: {
      brand: {
        name: "Hermes"
      }
    },
  });&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;An important trade-off in the index module&lt;/strong&gt; is the need to avoid the performance cost of &lt;code&gt;COUNT(*)&lt;/code&gt; queries, which can be an incredibly high cost for very large data sets. Instead, we use Postgres’ internal query planner to compute an estimated count of the result set. For very small data sets, this estimate can be very inaccurate, but for larger ones it should provide a reasonable estimate. The trade-off allows us to achieve very fast response times making it ideal for user-facing search and browsing experiences. As noted earlier, the tool is still experimental, and we plan to continue iterating and improving it over time.&lt;/p&gt;
&lt;h3&gt;Custom Tax Providers&lt;/h3&gt;
&lt;p&gt;This release introduces full support for custom Tax Providers by making these key changes:
- Load custom Tax Providers in the Tax Module
- Manage (create, update) provider per Tax Region in the admin dashboard
- Migrate all Tax Regions to use a tax provider&lt;/p&gt;
&lt;p&gt;The migration script will run the first time you start the server after upgrading. It will assign the default system provider to the Tax Region, if the region did not have a custom provider specified already.&lt;/p&gt;
&lt;h2&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;feat: upgrade opentelemetry packages to support the latest release by @thetutlage in https://github.com/medusajs/medusa/pull/12266&lt;/li&gt;
&lt;li&gt;feat(index): add filterable fields to link definition by @carlos-r-l-rodrigues in https://github.com/medusajs/medusa/pull/11898&lt;/li&gt;
&lt;li&gt;feat: add needed methods to the file module and providers by @thetutlage in https://github.com/medusajs/medusa/pull/12325&lt;/li&gt;
&lt;li&gt;feat(core-flows, utils): add OrderEdit events by @fPolic in https://github.com/medusajs/medusa/pull/12320&lt;/li&gt;
&lt;li&gt;feat: implement direct upload by @thetutlage in https://github.com/medusajs/medusa/pull/12328&lt;/li&gt;
&lt;li&gt;feat(dashboard, js-sdk, medusa, tax, types): custom tax providers by @fPolic in https://github.com/medusajs/medusa/pull/12297&lt;/li&gt;
&lt;li&gt;feat(product): search variants by product properties by @fPolic in https://github.com/medusajs/medusa/pull/12391&lt;/li&gt;
&lt;li&gt;fix(workflow-engine-*): q text search by @adrien2p in https://github.com/medusajs/medusa/pull/12435&lt;/li&gt;
&lt;li&gt;feat(core-flows): Emit cart trasnferred customer by @adrien2p in https://github.com/medusajs/medusa/pull/12425&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Bugs&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;fix(medusa): Fix store return API by @riqwan in https://github.com/medusajs/medusa/pull/12284&lt;/li&gt;
&lt;li&gt;fix(core-flows): handle inventory kit items in mark-as-shipped/delivered flows by @fPolic in https://github.com/medusajs/medusa/pull/12269&lt;/li&gt;
&lt;li&gt;fix(design-system): filter/sorting menu error by @fPolic in https://github.com/medusajs/medusa/pull/12309&lt;/li&gt;
&lt;li&gt;fix(core-flows): add missing remove remote link by @carlos-r-l-rodrigues in https://github.com/medusajs/medusa/pull/12326&lt;/li&gt;
&lt;li&gt;fix(core-flows,utils): move fulfillment workflow events by @shahednasser in https://github.com/medusajs/medusa/pull/12338&lt;/li&gt;
&lt;li&gt;fix: batch updates in upsertMany_ by @peterlgh7 in https://github.com/medusajs/medusa/pull/12333&lt;/li&gt;
&lt;li&gt;fix: export ProductImage to allow for custom links to add alt text by @thetutlage in https://github.com/medusajs/medusa/pull/12357&lt;/li&gt;
&lt;li&gt;fix(product): Return updated collections by @olivermrbl in https://github.com/medusajs/medusa/pull/12354&lt;/li&gt;
&lt;li&gt;fix(create-medusa-app): updates to text and prompts by @shahednasser in https://github.com/medusajs/medusa/pull/12360&lt;/li&gt;
&lt;li&gt;fix(medusa): Support additional data on admin/collections by @olivermrbl in https://github.com/medusajs/medusa/pull/12345&lt;/li&gt;
&lt;li&gt;fix(core-flows): export order-related utility workflows by @shahednasser in https://github.com/medusajs/medusa/pull/12380&lt;/li&gt;
&lt;li&gt;fix(medusa): check if tax module is installed when running tax migration script by @fPolic in https://github.com/medusajs/medusa/pull/12393&lt;/li&gt;
&lt;li&gt;fix: Use logger in the test runner and migration commands by @sradevski in https://github.com/medusajs/medusa/pull/12406&lt;/li&gt;
&lt;li&gt;fix: refactor batch product update by @peterlgh7 in https://github.com/medusajs/medusa/pull/12367&lt;/li&gt;
&lt;li&gt;fix(dashboard): tax regions UI polish by @fPolic in https://github.com/medusajs/medusa/pull/12437&lt;/li&gt;
&lt;li&gt;fix(core-flows): use product title for line item title by @fPolic in https://github.com/medusajs/medusa/pull/12397&lt;/li&gt;
&lt;li&gt;fix(dashboard): inventory kit combobox state by @fPolic in https://github.com/medusajs/medusa/pull/12371&lt;/li&gt;
&lt;li&gt;fix(core-flows): use transform as input to account holder step by @riqwan in https://github.com/medusajs/medusa/pull/12430&lt;/li&gt;
&lt;li&gt;fix(dashboard): call route modal onClose only on route change by @fPolic in https://github.com/medusajs/medusa/pull/12383&lt;/li&gt;
&lt;li&gt;fix(core-flows): Refund and recreate payment session on cart complete failure by @fPolic in https://github.com/medusajs/medusa/pull/12263&lt;/li&gt;
&lt;li&gt;fix(tax): Make system provider registration backward compatible by @olivermrbl in https://github.com/medusajs/medusa/pull/12441&lt;/li&gt;
&lt;li&gt;fix(dashboard, medusa): validate provider for top level tax regions by @fPolic in https://github.com/medusajs/medusa/pull/12450&lt;/li&gt;
&lt;li&gt;fix(core-flows, dashboard): reservation recreation on fulfilment cancel + allocation button display by @fPolic in https://github.com/medusajs/medusa/pull/12447&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Documentation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;docs: fix reference of draft orders JS SDK methods by @shahednasser in https://github.com/medusajs/medusa/pull/12271&lt;/li&gt;
&lt;li&gt;docs: fix core flows reference not generating by @shahednasser in https://github.com/medusajs/medusa/pull/12274&lt;/li&gt;
&lt;li&gt;docs: regenerate core-flows reference + OAS for draft order updates by @shahednasser in https://github.com/medusajs/medusa/pull/12280&lt;/li&gt;
&lt;li&gt;docs: clarify ISO format for province codes by @shahednasser in https://github.com/medusajs/medusa/pull/12282&lt;/li&gt;
&lt;li&gt;docs: add note to s3 guide by @shahednasser in https://github.com/medusajs/medusa/pull/12289&lt;/li&gt;
&lt;li&gt;docs: improve documetation around error handling in workflows by @shahednasser in https://github.com/medusajs/medusa/pull/12288&lt;/li&gt;
&lt;li&gt;docs: added mark fulfillment delivered step in digital products recipe by @shahednasser in https://github.com/medusajs/medusa/pull/12290&lt;/li&gt;
&lt;li&gt;docs-util: enable internal resolve for workflows sdk reference by @shahednasser in https://github.com/medusajs/medusa/pull/12292&lt;/li&gt;
&lt;li&gt;docs: improve resend guide by @shahednasser in https://github.com/medusajs/medusa/pull/12293&lt;/li&gt;
&lt;li&gt;Update 6.3. Using TypeScript Aliases - Alias should run after build, not before by @AlexanderLindkjaer in https://github.com/medusajs/medusa/pull/12272&lt;/li&gt;
&lt;li&gt;docs: general improvements and additions by @shahednasser in https://github.com/medusajs/medusa/pull/12296&lt;/li&gt;
&lt;li&gt;docs: fix troubleshooting page by @shahednasser in https://github.com/medusajs/medusa/pull/12305&lt;/li&gt;
&lt;li&gt;docs-util: add sidebar link validation in prep script by @shahednasser in https://github.com/medusajs/medusa/pull/12306&lt;/li&gt;
&lt;li&gt;docs: fix module name in product review guide by @shahednasser in https://github.com/medusajs/medusa/pull/12310&lt;/li&gt;
&lt;li&gt;docs(algolia): rename instructed filename to fit code-block and preserve naming conflict instructions by @MentorFilou in https://github.com/medusajs/medusa/pull/12300&lt;/li&gt;
&lt;li&gt;docs: improve installation documentation with diagrams by @shahednasser in https://github.com/medusajs/medusa/pull/12312&lt;/li&gt;
&lt;li&gt;docs: fix incorrect note usage in some workflow references by @shahednasser in https://github.com/medusajs/medusa/pull/12317&lt;/li&gt;
&lt;li&gt;docs: fix missing quotation mark in marketplace vendor tutorial curl request by @Obad94 in https://github.com/medusajs/medusa/pull/12315&lt;/li&gt;
&lt;li&gt;docs: localization with contentful guide by @shahednasser in https://github.com/medusajs/medusa/pull/12202&lt;/li&gt;
&lt;li&gt;docs-util: fix hook examples not showing in generated references by @shahednasser in https://github.com/medusajs/medusa/pull/12334&lt;/li&gt;
&lt;li&gt;docs: fix TypeScript errors in marketplace vendor tutorial by @Obad94 in https://github.com/medusajs/medusa/pull/12302&lt;/li&gt;
&lt;li&gt;docs-util: support deprecated tag in OAS by @shahednasser in https://github.com/medusajs/medusa/pull/12339&lt;/li&gt;
&lt;li&gt;docs-util: add script to generate events info by @shahednasser in https://github.com/medusajs/medusa/pull/12340&lt;/li&gt;
&lt;li&gt;docs: generate events reference by @shahednasser in https://github.com/medusajs/medusa/pull/12341&lt;/li&gt;
&lt;li&gt;docs: fix redirect on infrastructural modules by @shahednasser in https://github.com/medusajs/medusa/pull/12358&lt;/li&gt;
&lt;li&gt;docs: fix local links in UI docs by @shahednasser in https://github.com/medusajs/medusa/pull/12359&lt;/li&gt;
&lt;li&gt;docs: add script to catch bad redirects by @shahednasser in https://github.com/medusajs/medusa/pull/12361&lt;/li&gt;
&lt;li&gt;docs: add troubleshooting for index.html error by @shahednasser in https://github.com/medusajs/medusa/pull/12365&lt;/li&gt;
&lt;li&gt;docs: add missing details for tiered pricing by @shahednasser in https://github.com/medusajs/medusa/pull/12374&lt;/li&gt;
&lt;li&gt;docs-util: add events to workflows reference by @shahednasser in https://github.com/medusajs/medusa/pull/12376&lt;/li&gt;
&lt;li&gt;docs: generate event references by @shahednasser in https://github.com/medusajs/medusa/pull/12378&lt;/li&gt;
&lt;li&gt;docs-util: fix hook parameters not showing when using workflow input by @shahednasser in https://github.com/medusajs/medusa/pull/12382&lt;/li&gt;
&lt;li&gt;docs: fixes to navbar and sidebar in mobile by @shahednasser in https://github.com/medusajs/medusa/pull/12379&lt;/li&gt;
&lt;li&gt;docs: update import user guide text + add diagram in brand module guide by @shahednasser in https://github.com/medusajs/medusa/pull/12385&lt;/li&gt;
&lt;li&gt;docs-util: add events to generated OAS by @shahednasser in https://github.com/medusajs/medusa/pull/12390&lt;/li&gt;
&lt;li&gt;docs: show events emitted in an API route in the API reference by @shahednasser in https://github.com/medusajs/medusa/pull/12392&lt;/li&gt;
&lt;li&gt;docs: generate OAS with events by @shahednasser in https://github.com/medusajs/medusa/pull/12394&lt;/li&gt;
&lt;li&gt;docs: added bundled products guide by @shahednasser in https://github.com/medusajs/medusa/pull/12332&lt;/li&gt;
&lt;li&gt;docs: add copy subscriber button by @shahednasser in https://github.com/medusajs/medusa/pull/12405&lt;/li&gt;
&lt;li&gt;docs: generate references after adding copy subscriber button by @shahednasser in https://github.com/medusajs/medusa/pull/12407&lt;/li&gt;
&lt;li&gt;docs: add support for keywords in references by @shahednasser in https://github.com/medusajs/medusa/pull/12413&lt;/li&gt;
&lt;li&gt;docs: add class for header wrapper + keywords for payment guide by @shahednasser in https://github.com/medusajs/medusa/pull/12414&lt;/li&gt;
&lt;li&gt;chore: update Medusa UI packages in docs on new release by @shahednasser in https://github.com/medusajs/medusa/pull/12415&lt;/li&gt;
&lt;li&gt;docs: enable and send algolia events by @shahednasser in https://github.com/medusajs/medusa/pull/12416&lt;/li&gt;
&lt;li&gt;docs: updates to middlewares and protected API routes + new chapter by @shahednasser in https://github.com/medusajs/medusa/pull/12419&lt;/li&gt;
&lt;li&gt;docs: support version in events reference by @shahednasser in https://github.com/medusajs/medusa/pull/12422&lt;/li&gt;
&lt;li&gt;docs-util: add note for providers by @shahednasser in https://github.com/medusajs/medusa/pull/12432&lt;/li&gt;
&lt;li&gt;docs: support showing version of API route in API reference by @shahednasser in https://github.com/medusajs/medusa/pull/12433&lt;/li&gt;
&lt;li&gt;docs: fix keyboard navigation in search by @shahednasser in https://github.com/medusajs/medusa/pull/12434&lt;/li&gt;
&lt;li&gt;docs: support deprecated in API reference by @shahednasser in https://github.com/medusajs/medusa/pull/12438&lt;/li&gt;
&lt;li&gt;docs-util: fix dependencies passed to auth providers by @shahednasser in https://github.com/medusajs/medusa/pull/12445&lt;/li&gt;
&lt;li&gt;Update page.mdx to correct "th" to "the" by @dsvwilson in https://github.com/medusajs/medusa/pull/12446&lt;/li&gt;
&lt;li&gt;docs: added saved payment methods with Stripe tutorial by @shahednasser in https://github.com/medusajs/medusa/pull/12257&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Chores&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;chore(js-sdk): fix TSDocs of draft orders in JS SDK by @shahednasser in https://github.com/medusajs/medusa/pull/12270&lt;/li&gt;
&lt;li&gt;chore(core-flows, types): add tsdocs for draft orders workflows by @shahednasser in https://github.com/medusajs/medusa/pull/12279&lt;/li&gt;
&lt;li&gt;chore(types): claify province code format in TSDocs by @shahednasser in https://github.com/medusajs/medusa/pull/12283&lt;/li&gt;
&lt;li&gt;chore(core-flows): fix note usage in TSDocs by @shahednasser in https://github.com/medusajs/medusa/pull/12318&lt;/li&gt;
&lt;li&gt;chore: add tsdocs for events by @shahednasser in https://github.com/medusajs/medusa/pull/12337&lt;/li&gt;
&lt;li&gt;chore(utils): fixes to events TSDocs by @shahednasser in https://github.com/medusajs/medusa/pull/12342&lt;/li&gt;
&lt;li&gt;chore(types): add note in TSDocs of list and retrieve methods by @shahednasser in https://github.com/medusajs/medusa/pull/12364&lt;/li&gt;
&lt;li&gt;feat(workflows-*): Allow to re run non idempotent but stored workflow with the same transaction id if considered done by @adrien2p in https://github.com/medusajs/medusa/pull/12362&lt;/li&gt;
&lt;li&gt;chore(utils): fixes to events TSDocs by @shahednasser in https://github.com/medusajs/medusa/pull/12395&lt;/li&gt;
&lt;li&gt;chore: Minor restructure of cart completion by @olivermrbl in https://github.com/medusajs/medusa/pull/12353&lt;/li&gt;
&lt;li&gt;chore: update generate references action to generate / commit events by @shahednasser in https://github.com/medusajs/medusa/pull/12411&lt;/li&gt;
&lt;li&gt;chore(utils): small fix to payload in TSDocs by @shahednasser in https://github.com/medusajs/medusa/pull/12409&lt;/li&gt;
&lt;li&gt;chore(utils): add version tag to order edit events by @shahednasser in https://github.com/medusajs/medusa/pull/12424&lt;/li&gt;
&lt;li&gt;test(workflow-engine): Ensure failed subscriber does not compensate workflows by @adrien2p in https://github.com/medusajs/medusa/pull/12427&lt;/li&gt;
&lt;li&gt;chore(js-sdk,types,utils): updates to file TSDocs by @shahednasser in https://github.com/medusajs/medusa/pull/12426&lt;/li&gt;
&lt;li&gt;chore(js-sdk, types): update TSDocs related to tax provider changes by @shahednasser in https://github.com/medusajs/medusa/pull/12428&lt;/li&gt;
&lt;li&gt;chore(medusa): add version tag for new routes by @shahednasser in https://github.com/medusajs/medusa/pull/12436&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Other Changes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;docs: improve database operations docs + added data model repository reference by @shahednasser in https://github.com/medusajs/medusa/pull/12273&lt;/li&gt;
&lt;li&gt;feat: internationalize hard-coded strings in product-create-general-section.tsx by @MentorFilou in https://github.com/medusajs/medusa/pull/12264&lt;/li&gt;
&lt;li&gt;test: use jest shards and simplify test-cli-pipeline by @thetutlage in https://github.com/medusajs/medusa/pull/12278&lt;/li&gt;
&lt;li&gt;fix(dashboard): Admin Global Search broken for variants by @AmbroziuBaban in https://github.com/medusajs/medusa/pull/11877&lt;/li&gt;
&lt;li&gt;chore: Update teams.yml by @olivermrbl in https://github.com/medusajs/medusa/pull/12355&lt;/li&gt;
&lt;li&gt;fix: rename Macedonia FYROM to North Macedonia by @edinabazi in https://github.com/medusajs/medusa/pull/12375&lt;/li&gt;
&lt;li&gt;fix: Added missing admin dashboard dependencies by @pepijn-vanvlaanderen in https://github.com/medusajs/medusa/pull/12346&lt;/li&gt;
&lt;li&gt;test(core-flows): Ensure productVariantUpdated failure compensate the workflow by @adrien2p in https://github.com/medusajs/medusa/pull/12381&lt;/li&gt;
&lt;li&gt;fix(plugins, utils): Plugin admin folder loading with backslash on Windows by @Betanoir in https://github.com/medusajs/medusa/pull/12418&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;New Contributors&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;@AlexanderLindkjaer made their first contribution in https://github.com/medusajs/medusa/pull/12272&lt;/li&gt;
&lt;li&gt;@MentorFilou made their first contribution in https://github.com/medusajs/medusa/pull/12264&lt;/li&gt;
&lt;li&gt;@Obad94 made their first contribution in https://github.com/medusajs/medusa/pull/12315&lt;/li&gt;
&lt;li&gt;@edinabazi made their first contribution in https://github.com/medusajs/medusa/pull/12375&lt;/li&gt;
&lt;li&gt;@Betanoir made their first contribution in https://github.com/medusajs/medusa/pull/12418&lt;/li&gt;
&lt;li&gt;@dsvwilson made their first contribution in https://github.com/medusajs/medusa/pull/12446&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Full Changelog&lt;/strong&gt;: https://github.com/medusajs/medusa/compare/v2.7.1...v2.8.0&lt;/p&gt;</content>
    <link href="https://github.com/medusajs/medusa/releases/tag/v2.8.0" rel="alternate"/>
  </entry>
  <entry>
    <id>https://github.com/medusajs/medusa/releases/tag/v2.8.1</id>
    <title>New release for Medusa: v2.8.1</title>
    <updated>2025-05-15T03:53:19-04:00</updated>
    <author>
      <name>medusajs/medusa</name>
    </author>
    <content>&lt;!-- 
![2-8-1](https://gh-release-images.s3.eu-north-1.amazonaws.com/v2-8-1.png)

# v2.8.1: Fixes regression related to product variant price updates

This release fixes a regression introduced in v2.8.0 related to product ordering in service responses, leading to incorrect pricing updates on products.

CMS_BREAK --&gt;

&lt;h2&gt;Highlights&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Fixes a regression introduced in v2.8.0&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In v2.8.0, we unintentionally introduced a regression that affected ordering products returned from the product module service. This broke workflows (e.g. &lt;code&gt;updateProductsWorkflow&lt;/code&gt;) that rely on consistent ordering for subsequent operations such as applying price updates. This release brings back the correct ordering behavior and resolves the issue. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;We strongly recommend upgrading to v2.8.1 as soon as possible to avoid incorrect data.&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;feat: create CSV normalizer to normalize a CSV file by @thetutlage in https://github.com/medusajs/medusa/pull/12396&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Bugs&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;fix(workflows-sdk): Miss match context usage within run as step by @adrien2p in https://github.com/medusajs/medusa/pull/12449&lt;/li&gt;
&lt;li&gt;fix(index): query builder handle json array by @carlos-r-l-rodrigues in https://github.com/medusajs/medusa/pull/12480&lt;/li&gt;
&lt;li&gt;fix: returned updates order in upsertWithReplace by @peterlgh7 in https://github.com/medusajs/medusa/pull/12486&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Documentation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;docs: tax provider updates for next release by @shahednasser in https://github.com/medusajs/medusa/pull/12431&lt;/li&gt;
&lt;li&gt;docs: update read-only links by @shahednasser in https://github.com/medusajs/medusa/pull/12468&lt;/li&gt;
&lt;li&gt;docs: fix client side error in references by @shahednasser in https://github.com/medusajs/medusa/pull/12475&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Chores&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;chore(types,utils): add featureFlag and version tags by @shahednasser in https://github.com/medusajs/medusa/pull/12464&lt;/li&gt;
&lt;li&gt;Chore/test runner improvements by @adrien2p in https://github.com/medusajs/medusa/pull/12439&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Full Changelog&lt;/strong&gt;: https://github.com/medusajs/medusa/compare/v2.8.0...v2.8.1&lt;/p&gt;</content>
    <link href="https://github.com/medusajs/medusa/releases/tag/v2.8.1" rel="alternate"/>
  </entry>
  <entry>
    <id>https://github.com/medusajs/medusa/releases/tag/v2.8.2</id>
    <title>New release for Medusa: v2.8.2</title>
    <updated>2025-05-16T05:36:36-04:00</updated>
    <author>
      <name>medusajs/medusa</name>
    </author>
    <content>&lt;!-- 
![2-8-2](https://gh-release-images.s3.eu-north-1.amazonaws.com/v2-8-2.png)

# v2.8.2: Fixes regression related to updating weight, height, length, and width on products

This release fixes a regression introduced in v2.8.2 when updating weight, height, length, and width on products.

CMS_BREAK --&gt;

&lt;h2&gt;Highlights&lt;/h2&gt;
&lt;h3&gt;Fixes regression related to updating weight, height, length, and width on products&lt;/h3&gt;
&lt;h2&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;feat: define validators and use normalize-products step by @thetutlage in https://github.com/medusajs/medusa/pull/12473&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Bugs&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;fix(types): change update signature of IAuthProvider by @shahednasser in https://github.com/medusajs/medusa/pull/12496&lt;/li&gt;
&lt;li&gt;fix: fix weight/length/height/width types in updates by @peterlgh7 in https://github.com/medusajs/medusa/pull/12500&lt;/li&gt;
&lt;li&gt;fix(core-flows): fulfilment cancelation with shared inventory kit item by @fPolic in https://github.com/medusajs/medusa/pull/12503&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Documentation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;docs: add missing methods in guides and references by @shahednasser in https://github.com/medusajs/medusa/pull/12495&lt;/li&gt;
&lt;li&gt;docs: improve payment-related guides by @shahednasser in https://github.com/medusajs/medusa/pull/12502&lt;/li&gt;
&lt;li&gt;docs: update examples in sendgrid guide by @shahednasser in https://github.com/medusajs/medusa/pull/12504&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Chores&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;chore(types, utils): TSDoc improvements for providers by @shahednasser in https://github.com/medusajs/medusa/pull/12498&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Full Changelog&lt;/strong&gt;: https://github.com/medusajs/medusa/compare/v2.8.1...v2.8.2&lt;/p&gt;</content>
    <link href="https://github.com/medusajs/medusa/releases/tag/v2.8.2" rel="alternate"/>
  </entry>
  <entry>
    <id>https://github.com/medusajs/medusa/releases/tag/v2.8.3</id>
    <title>New release for Medusa: v2.8.3</title>
    <updated>2025-05-22T08:10:01-04:00</updated>
    <author>
      <name>medusajs/medusa</name>
    </author>
    <content>&lt;!-- 
![2-8-3](https://gh-release-images.s3.eu-north-1.amazonaws.com/v2-8-3.png)

# v2.8.3: New Analytics module and a Posthog provider

This release introduces a new Analytics module for server-side tracking. The module comes with an official Posthog provider.

CMS_BREAK --&gt;

&lt;h2&gt;Highlights&lt;/h2&gt;
&lt;h3&gt;New Analytics module and Posthog provider&lt;/h3&gt;
&lt;p&gt;This release introduces a new Analytics module, allowing you to easily set up server-side tracking of events and users.&lt;/p&gt;
&lt;p&gt;The module comes with two methods:
```ts
 /*&lt;em&gt;
   * This method tracks an event in the analytics provider.
   *
   * @param {TrackAnalyticsEventDTO} data - The event's details.
   * @returns {Promise&lt;void&gt;} Resolves when the event is tracked successfully.
   *
   * @example
   * await analyticsModuleService.track({
   *   event: "order_placed",
   *   properties: {
   *     order_id: "order_123",
   *     customer_id: "customer_456",
   *     total: 100,
   *   }
   * })
   &lt;/em&gt;/
track(data: TrackAnalyticsEventDTO): Promise&lt;void&gt;&lt;/p&gt;
&lt;p&gt;/*&lt;em&gt;
   * This method identifies an actor or group in the analytics provider.
   *
   * @param {IdentifyAnalyticsEventDTO} data - The details of the actor or group.
   * @returns {Promise&lt;void&gt;} Resolves when the actor or group is identified successfully.
   *
   * @example
   * await analyticsModuleService.identify({
   *   actor_id: "123",
   *   properties: {
   *     name: "John Doe"
   *   }
   * })
   &lt;/em&gt;/
identify(data: IdentifyAnalyticsEventDTO): Promise&lt;void&gt;
```&lt;/p&gt;
&lt;p&gt;To configure the Analytics module, register it in the &lt;code&gt;modules&lt;/code&gt; of your &lt;code&gt;medusa-config.ts&lt;/code&gt;:
&lt;code&gt;ts
  ...
  modules: [
    ...,
    {
      resolve: "@medusajs/medusa/analytics",
      options: {
        providers: [{ ... }],
      },
    },
  ],
  ...&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The Analytics module does not do much as is. You need to configure a provider responsible for handling the tracking. This release comes with two moduNopeles, &lt;code&gt;@medusajs/analytics-local&lt;/code&gt; and &lt;code&gt;@medusajs/analytics-posthog&lt;/code&gt;. The former will log the events and can be used for local development. The latter is an official integration with &lt;a href="https://posthog.com/"&gt;Posthog&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;The provider is installed like so:
&lt;code&gt;ts
  ...
  modules: [
    ...,
    {
      resolve: "@medusajs/medusa/analytics",
      options: {
        providers: [ 
          {
            resolve: "@medusajs/analytics-posthog",
            options: {
              posthogEventsKey: "&amp;lt;your-api-key&amp;gt;",
              posthogHost: "&amp;lt;your host&amp;gt;",
            }
          }
      }],
    },
  ],
  ...&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Read more about the new module and providers in our &lt;a href="https://docs.medusajs.com/resources/infrastructure-modules/analytics"&gt;documentation&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;feat(index): Only run the synchronisation in worker/shared mode by @adrien2p in https://github.com/medusajs/medusa/pull/12530&lt;/li&gt;
&lt;li&gt;chore(product, modules-sdk): Add missing index for select-in strategy + allow to pass top level strategy to force the behaviour by @adrien2p in https://github.com/medusajs/medusa/pull/12508&lt;/li&gt;
&lt;li&gt;feat: Add an analytics module and local and posthog providers by @sradevski in https://github.com/medusajs/medusa/pull/12505&lt;/li&gt;
&lt;li&gt;feat: process import from pre-processed chunks by @thetutlage in https://github.com/medusajs/medusa/pull/12527&lt;/li&gt;
&lt;li&gt;feat: add presignedUrl method to upload sdk by @christiananese in https://github.com/medusajs/medusa/pull/12569&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Bugs&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;fix: Skip migration if module is not installed by @sradevski in https://github.com/medusajs/medusa/pull/12507&lt;/li&gt;
&lt;li&gt;test: remove snapshots usage by @thetutlage in https://github.com/medusajs/medusa/pull/12516&lt;/li&gt;
&lt;li&gt;fix(utils): Missing zod deps by @adrien2p in https://github.com/medusajs/medusa/pull/12518&lt;/li&gt;
&lt;li&gt;fix(dashboard): refund payment formatting by @fPolic in https://github.com/medusajs/medusa/pull/12476&lt;/li&gt;
&lt;li&gt;fix(medusa): add estimate count to admin products by @carlos-r-l-rodrigues in https://github.com/medusajs/medusa/pull/12467&lt;/li&gt;
&lt;li&gt;fix(index): Apply various fixes to the index engine by @carlos-r-l-rodrigues in https://github.com/medusajs/medusa/pull/12501&lt;/li&gt;
&lt;li&gt;fix: Correctly import MedusaError in the analytics module by @sradevski in https://github.com/medusajs/medusa/pull/12542&lt;/li&gt;
&lt;li&gt;fix(product): Deep update data retrieval bottleneck by @adrien2p in https://github.com/medusajs/medusa/pull/12538&lt;/li&gt;
&lt;li&gt;fix: mark posthog-node as a peer dependency by @thetutlage in https://github.com/medusajs/medusa/pull/12539&lt;/li&gt;
&lt;li&gt;fix(js-sdk): allow passing custom request body parameters in auth.register method by @shahednasser in https://github.com/medusajs/medusa/pull/12545&lt;/li&gt;
&lt;li&gt;fix(core-flows): skip location check if inventory is not managed by @fPolic in https://github.com/medusajs/medusa/pull/12540&lt;/li&gt;
&lt;li&gt;fix(core-flows, types): export steps and types related to credit lines by @shahednasser in https://github.com/medusajs/medusa/pull/12567&lt;/li&gt;
&lt;li&gt;fix(product, utils): handle metadata key deletion on product update by @fPolic in https://github.com/medusajs/medusa/pull/12478&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Documentation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;docs: update recipe contents by @shahednasser in https://github.com/medusajs/medusa/pull/12515&lt;/li&gt;
&lt;li&gt;docs: add vale rule for Next.js Starter Storefront by @shahednasser in https://github.com/medusajs/medusa/pull/12517&lt;/li&gt;
&lt;li&gt;docs: change recipes on homepage by @shahednasser in https://github.com/medusajs/medusa/pull/12520&lt;/li&gt;
&lt;li&gt;docs: fix timeout in order-related workflows reference by @shahednasser in https://github.com/medusajs/medusa/pull/12533&lt;/li&gt;
&lt;li&gt;docs: added re-order guide by @shahednasser in https://github.com/medusajs/medusa/pull/12363&lt;/li&gt;
&lt;li&gt;chore(docs): Update npm command by @kashifaris in https://github.com/medusajs/medusa/pull/12547&lt;/li&gt;
&lt;li&gt;docs: show hooks in when condition in workflows reference by @shahednasser in https://github.com/medusajs/medusa/pull/12552&lt;/li&gt;
&lt;li&gt;docs-util: extract feature flags in generated OAS by @shahednasser in https://github.com/medusajs/medusa/pull/12554&lt;/li&gt;
&lt;li&gt;Fix: Incorrect Example File Name in Subscriber Section by @adityaerlangga in https://github.com/medusajs/medusa/pull/12560&lt;/li&gt;
&lt;li&gt;docs: improve module isolation chapter by @shahednasser in https://github.com/medusajs/medusa/pull/12565&lt;/li&gt;
&lt;li&gt;docs: show when condition in workflows reference by @shahednasser in https://github.com/medusajs/medusa/pull/12566&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Chores&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;test(workflow-engine-redist): Update tests to ensure behaviour validation properly by @adrien2p in https://github.com/medusajs/medusa/pull/12514&lt;/li&gt;
&lt;li&gt;chore(test-cli-with-database): Update cli tag from latest to preview by @adrien2p in https://github.com/medusajs/medusa/pull/12529&lt;/li&gt;
&lt;li&gt;chore(index): return ids only by @carlos-r-l-rodrigues in https://github.com/medusajs/medusa/pull/12543&lt;/li&gt;
&lt;li&gt;chore(core-flows): add tsdocs for hooks in complete cart by @shahednasser in https://github.com/medusajs/medusa/pull/12555&lt;/li&gt;
&lt;li&gt;chore(types, utils): update TSDocs related to analytics module by @shahednasser in https://github.com/medusajs/medusa/pull/12564&lt;/li&gt;
&lt;li&gt;chore(index): Few adjustments by @adrien2p in https://github.com/medusajs/medusa/pull/12557&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Other Changes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Typo/index logs by @adrien2p in https://github.com/medusajs/medusa/pull/12528&lt;/li&gt;
&lt;li&gt;fix: Fix garbled characters in zhCN.json translation file by @imhuso in https://github.com/medusajs/medusa/pull/12537&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;New Contributors&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;@imhuso made their first contribution in https://github.com/medusajs/medusa/pull/12537&lt;/li&gt;
&lt;li&gt;@kashifaris made their first contribution in https://github.com/medusajs/medusa/pull/12547&lt;/li&gt;
&lt;li&gt;@adityaerlangga made their first contribution in https://github.com/medusajs/medusa/pull/12560&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Full Changelog&lt;/strong&gt;: https://github.com/medusajs/medusa/compare/v2.8.2...v2.8.3&lt;/p&gt;</content>
    <link href="https://github.com/medusajs/medusa/releases/tag/v2.8.3" rel="alternate"/>
  </entry>
  <entry>
    <id>https://github.com/medusajs/medusa/releases/tag/v2.8.4</id>
    <title>New release for Medusa: v2.8.4</title>
    <updated>2025-06-05T14:43:48-04:00</updated>
    <author>
      <name>medusajs/medusa</name>
    </author>
    <content>&lt;!-- 
![2-8-4](https://gh-release-images.s3.eu-north-1.amazonaws.com/v2-8-4.png)

# v2.8.4: Strengthening of cart-completion flows

This release strengthens the cart-completion flow by eliminating a potential race condition that in rare cases could lead to an unexpected payment outcome.

CMS_BREAK --&gt;

&lt;h2&gt;Highlights&lt;/h2&gt;
&lt;h3&gt;Eliminate race condition in cart-completion flow&lt;/h3&gt;
&lt;p&gt;This release strengthens the cart-completion flow by eliminating a potential race condition that, in rare cases, could result in an incorrectly refunded payment. &lt;/p&gt;
&lt;p&gt;The race condition occurs when cart completion is triggered from two sources: 1) the regular HTTP request to &lt;code&gt;POST /store/carts/:id/complete&lt;/code&gt;, and 2) a webhook event from the payment provider signaling successful payment authorization.&lt;/p&gt;
&lt;p&gt;To reduce the risk of a conflict, we have, up until now, delayed webhook processing by 5 seconds. However, this mitigation proved insufficient in some cases.&lt;/p&gt;
&lt;p&gt;Now, whenever the &lt;code&gt;completeCartWorkflow&lt;/code&gt; is executed whether via the API route or the webhook handler, we now hold a lock on the cart ID for the duration of the workflow. This lock ensures that multiple completion attempts for the same cart are processed sequentially. Once a cart is successfully completed (typically on the first attempt), subsequent attempts will detect the completed cart and exit early, returning the associated order. &lt;/p&gt;
&lt;h2&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;feat: run workflow hooks inside a when/then block by @thetutlage in https://github.com/medusajs/medusa/pull/11963&lt;/li&gt;
&lt;li&gt;feat: introduce bulkDelete method for IFileProvider by @thetutlage in https://github.com/medusajs/medusa/pull/12614&lt;/li&gt;
&lt;li&gt;feat(core-flows,js-sdk,medusa,types): draft order delete by @fPolic in https://github.com/medusajs/medusa/pull/12172&lt;/li&gt;
&lt;li&gt;feat: implement stream based processing of the files by @thetutlage in https://github.com/medusajs/medusa/pull/12574&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Bugs&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;fix: Correctly list files for all ids that are passed by @sradevski in https://github.com/medusajs/medusa/pull/12575&lt;/li&gt;
&lt;li&gt;fix(framework): Fix compiler to create the dist after clean-up by @adrien2p in https://github.com/medusajs/medusa/pull/12582&lt;/li&gt;
&lt;li&gt;fix: module import paths to contain unix slash by @thetutlage in https://github.com/medusajs/medusa/pull/12592&lt;/li&gt;
&lt;li&gt;fix: expand method ALL for bodyparser config and additional validator by @thetutlage in https://github.com/medusajs/medusa/pull/12612&lt;/li&gt;
&lt;li&gt;fix(dashboard): combobox initial item cache by @fPolic in https://github.com/medusajs/medusa/pull/12522&lt;/li&gt;
&lt;li&gt;fix(core-flows): reservation management on order edit and draft order confirm by @fPolic in https://github.com/medusajs/medusa/pull/12546&lt;/li&gt;
&lt;li&gt;fix(utils): move payment events to core flows events by @shahednasser in https://github.com/medusajs/medusa/pull/12636&lt;/li&gt;
&lt;li&gt;fix(analytics): fix type of provider option by @shahednasser in https://github.com/medusajs/medusa/pull/12642&lt;/li&gt;
&lt;li&gt;fix(core-flows): complete cart improvements by @carlos-r-l-rodrigues in https://github.com/medusajs/medusa/pull/12646&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Documentation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;docs: fix example in marketplace recipe by @shahednasser in https://github.com/medusajs/medusa/pull/12595&lt;/li&gt;
&lt;li&gt;docs: add support for ignoring hooks by @shahednasser in https://github.com/medusajs/medusa/pull/12599&lt;/li&gt;
&lt;li&gt;docs: document using env vars in plugins by @shahednasser in https://github.com/medusajs/medusa/pull/12618&lt;/li&gt;
&lt;li&gt;docs: add setup details to contribution guidelines by @shahednasser in https://github.com/medusajs/medusa/pull/12619&lt;/li&gt;
&lt;li&gt;docs: add missing equal sign for DATABASE_URL in env example by @Amar2Kk in https://github.com/medusajs/medusa/pull/12620&lt;/li&gt;
&lt;li&gt;docs: phone authentication + otp guide by @shahednasser in https://github.com/medusajs/medusa/pull/12544&lt;/li&gt;
&lt;li&gt;chore(types): fix example for createProductOptionValues in TSDocs and docs by @shahednasser in https://github.com/medusajs/medusa/pull/12623&lt;/li&gt;
&lt;li&gt;chore(core-flows, types): change base64 comment fo files in TSDocs to binary by @shahednasser in https://github.com/medusajs/medusa/pull/12627&lt;/li&gt;
&lt;li&gt;docs: redesign search by @shahednasser in https://github.com/medusajs/medusa/pull/12628&lt;/li&gt;
&lt;li&gt;docs: fix loading in order reference pages by @shahednasser in https://github.com/medusajs/medusa/pull/12629&lt;/li&gt;
&lt;li&gt;docs: added segment guide by @shahednasser in https://github.com/medusajs/medusa/pull/12616&lt;/li&gt;
&lt;li&gt;docs: fix broken links utility + uncaught broken links by @shahednasser in https://github.com/medusajs/medusa/pull/12637&lt;/li&gt;
&lt;li&gt;docs: redesign table of content by @shahednasser in https://github.com/medusajs/medusa/pull/12647&lt;/li&gt;
&lt;li&gt;docs: fix log levels list by @shahednasser in https://github.com/medusajs/medusa/pull/12648&lt;/li&gt;
&lt;li&gt;fix(docs): correct module reference in useQueryGraphStep tip by @Amar2Kk in https://github.com/medusajs/medusa/pull/12654&lt;/li&gt;
&lt;li&gt;docs: add an example of injecting dependencies in module providers by @shahednasser in https://github.com/medusajs/medusa/pull/12663&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Chores&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;chore(modules-sdk): Log full error when a loader fail to run by @adrien2p in https://github.com/medusajs/medusa/pull/12584&lt;/li&gt;
&lt;li&gt;chore(core-flows): ignore hooks in complete cart workflow by @shahednasser in https://github.com/medusajs/medusa/pull/12600&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Other Changes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;update Chinese translation files by @leosin in https://github.com/medusajs/medusa/pull/12611&lt;/li&gt;
&lt;li&gt;feat: add hebrew admin translation by @GuyPaikowsky in https://github.com/medusajs/medusa/pull/12603&lt;/li&gt;
&lt;li&gt;feat(admin): Add Bahasa Indonesia language support by @Slackluky in https://github.com/medusajs/medusa/pull/12657&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;New Contributors&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;@Amar2Kk made their first contribution in https://github.com/medusajs/medusa/pull/12620&lt;/li&gt;
&lt;li&gt;@GuyPaikowsky made their first contribution in https://github.com/medusajs/medusa/pull/12603&lt;/li&gt;
&lt;li&gt;@Slackluky made their first contribution in https://github.com/medusajs/medusa/pull/12657&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Full Changelog&lt;/strong&gt;: https://github.com/medusajs/medusa/compare/v2.8.3...v2.8.4&lt;/p&gt;</content>
    <link href="https://github.com/medusajs/medusa/releases/tag/v2.8.4" rel="alternate"/>
  </entry>
</feed>
