<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
  <id>https://selfh.st/apps</id>
  <title>RunsOn Releases</title>
  <updated>2024-10-20T13:33:04.228692-04:00</updated>
  <author>
    <name>selfh.st</name>
    <email>contact@selfh.st</email>
  </author>
  <link href="https://selfh.st/apps" rel="alternate"/>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <subtitle>Self-hosted software releases generated by selfh.st</subtitle>
  <entry>
    <id>https://github.com/runs-on/runs-on/releases/tag/v2.3.2</id>
    <title>New release for RunsOn: </title>
    <updated>2024-06-21T08:07:10-04:00</updated>
    <author>
      <name>runs-on/runs-on</name>
    </author>
    <content>&lt;p&gt;Summary: a fix for useless creation of instances when hitting quota errors, reverting the unbounded &lt;code&gt;cpu&lt;/code&gt; and &lt;code&gt;ram&lt;/code&gt; change (from v2.3.0), and CloudWatch agent now streams instance logs into CloudWatch.&lt;/p&gt;
&lt;h2&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The change introduced in &lt;code&gt;v2.3.0&lt;/code&gt; expanded the instance choice by allowing instances with more CPUs and RAM than specified to be included. This has been reverted to avoid confusion, and to avoid hitting quota limits more frequently. Instead, RunsOn will take the lowest and highest value from the &lt;code&gt;cpu&lt;/code&gt; and &lt;code&gt;ram&lt;/code&gt; definitions, and set that as min and max values when requesting an instance. If you want to keep the behaviour introduced in &lt;code&gt;v2.3.0&lt;/code&gt;, you can now simply do e.g. &lt;code&gt;cpu=4+256&lt;/code&gt; and it will evaluate all instances with cpus from 4 to 256. You no longer need to set multiple values like &lt;code&gt;cpu=4+8+16+32...&lt;/code&gt;, since only the min and max values will be used. As another example, setting &lt;code&gt;cpu=4&lt;/code&gt; will only include instance with 4 CPUs, as it was the case before &lt;code&gt;v2.3.0&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Automatically send cloud-init logs to CloudWatch. Should help a lot with knowing what happened on an instance in case it terminated early. Currently ships &lt;code&gt;/var/log/cloud-init-output.log&lt;/code&gt;, &lt;code&gt;/var/log/syslog&lt;/code&gt;, and &lt;code&gt;/var/log/cloudwatch-agent.log&lt;/code&gt;. Retention set to 7 days. Requires the CloudWatch agent to be installed on the base AMI (&lt;code&gt;amazon-cloudwatch-agent-ctl&lt;/code&gt; must be in the &lt;code&gt;PATH&lt;/code&gt;).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;New CloudFormation parameter to enable/disable detailed monitoring for EC2 instances (default: &lt;code&gt;false&lt;/code&gt;).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add &lt;code&gt;job_url&lt;/code&gt; to all log messages.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add &lt;code&gt;runs-on-workflow-run-id&lt;/code&gt; tag on instance, when job has started.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;All instances will now get a &lt;code&gt;Name&lt;/code&gt; assigned when the instance starts processing a job from GitHub. Quite useful to monitor at a glance in EC2 UI which instances have started processing jobs.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img width="846" alt="image" src="https://github.com/runs-on/runs-on/assets/6114/cd6a1824-cca2-4697-887f-81a39003389b"&gt;&lt;/p&gt;
&lt;h2&gt;Fixes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;CreateFleet&lt;/code&gt; API can sometimes return an instance, even if errors are present in the response. Checking this fixes an issue that was creating more instances than necessary when hitting e.g. quota errors.&lt;/li&gt;
&lt;li&gt;Ensure runner waits up to 10s until all tags have been set on the instance before shutting down.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Misc&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Always prepend preinstall script with &lt;code&gt;#!/bin/bash -e&lt;/code&gt;, and make RunsOn environment variables accessible.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Upgrade&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://runs-on.com/guides/upgrade/"&gt;Upgrade Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CloudFormation Template URL: https://runs-on.s3.eu-west-1.amazonaws.com/cloudformation/template.yaml&lt;/li&gt;
&lt;li&gt;CloudFormation Versioned template URL: https://runs-on.s3.eu-west-1.amazonaws.com/cloudformation/template-v2.3.2.yaml&lt;/li&gt;
&lt;/ul&gt;</content>
    <link href="https://github.com/runs-on/runs-on/releases/tag/v2.3.2" rel="alternate"/>
  </entry>
  <entry>
    <id>https://github.com/runs-on/runs-on/releases/tag/v2.5.0</id>
    <title>New release for RunsOn: v2.5.0</title>
    <updated>2024-08-28T03:50:30-04:00</updated>
    <author>
      <name>runs-on/runs-on</name>
    </author>
    <content>&lt;p&gt;Summary: Allow to assign an environment name to each RunsOn stack. Allow to specify VPC CIDR block and export outputs to facilitate VPC peering connections. Allow to set custom tags on instances.&lt;/p&gt;
&lt;h2&gt;Potentially breaking changes&lt;/h2&gt;
&lt;p&gt;If you have set the &lt;code&gt;Private&lt;/code&gt; parameter to &lt;code&gt;true&lt;/code&gt; in the CloudFormation template, the behaviour has changed:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The stack will now create only 1 managed NAT gateway (instead of 3) when enabling &lt;code&gt;Private&lt;/code&gt; mode, to save on costs.&lt;/li&gt;
&lt;li&gt;Also, runners will be launched in the private subnets &lt;strong&gt;only if the label &lt;code&gt;private=true&lt;/code&gt; is present&lt;/strong&gt; in the &lt;code&gt;runs-on:&lt;/code&gt; definition. This way, runners will launch in the public subnets by default, and you can selectively use the private subnet (to get the egress static IP) for specific workflows. This saves on NAT bandwidth costs since most workflows don't need static IP.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Allow assigning an environment name to a RunsOn stack (default &lt;code&gt;production&lt;/code&gt;), which can then be targeted by using the &lt;code&gt;env&lt;/code&gt; label in the workflow. This allows setting up multiple isolated RunsOn stacks to handle environments such as &lt;code&gt;staging&lt;/code&gt; etc. with different IAM permissions or configurations. Fixes #120.&lt;/li&gt;
&lt;li&gt;Allow specifying a custom VPC CIDR block when creating the stack. This helps if you plan on establishing VPC peering connections with your RunsOn runners. Note that updating this parameter for existing stacks is not recommended. You should create a new stack instead, and remove the old one. Fixes #114.&lt;/li&gt;
&lt;li&gt;Provide a CloudFormation template to facilitate the establishment of a VPC peering connection between RunsOn's VPC, and a destination VPC.&lt;/li&gt;
&lt;li&gt;Allow setting custom tags on the instances launched by RunsOn (&lt;code&gt;RunnerCustomTags&lt;/code&gt; CloudFormation parameter). Fixes #119.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Upgrade&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://runs-on.com/guides/upgrade/"&gt;Upgrade Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CloudFormation Versioned template URL: https://runs-on.s3.eu-west-1.amazonaws.com/cloudformation/template-v2.5.0.yaml&lt;/li&gt;
&lt;li&gt;CloudFormation Template URL: https://runs-on.s3.eu-west-1.amazonaws.com/cloudformation/template.yaml&lt;/li&gt;
&lt;/ul&gt;</content>
    <link href="https://github.com/runs-on/runs-on/releases/tag/v2.5.0" rel="alternate"/>
  </entry>
  <entry>
    <id>https://github.com/runs-on/runs-on/releases/tag/v2.5.4</id>
    <title>New release for RunsOn: v2.5.4</title>
    <updated>2024-09-25T11:16:35-04:00</updated>
    <author>
      <name>runs-on/runs-on</name>
    </author>
    <content>&lt;p&gt;New ubuntu24 images, new housekeeping task to auto-restart instances that failed to launch, new always-on Private setting, additional runner details in logs, and more.&lt;/p&gt;
&lt;h2&gt;Notable changes (from v2.5.0 to v2.5.4)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Add ubuntu24 official images: &lt;code&gt;ubuntu24-full-x64&lt;/code&gt; and &lt;code&gt;ubuntu24-full-arm64&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Private&lt;/code&gt; CloudFormation parameter now accepts &lt;code&gt;always&lt;/code&gt; as value, in which case the runners will always launch in the private subnets by default (unless opt-out with &lt;code&gt;private=false&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;Display GitHub current rate-limits in logs (search for &lt;code&gt;tokens&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;Add 'Private' dimension to cloudwatch stats.&lt;/li&gt;
&lt;li&gt;Add &lt;code&gt;Environment&lt;/code&gt;, &lt;code&gt;IsPrivate&lt;/code&gt;, and &lt;code&gt;StaticIp&lt;/code&gt; (if IsPrivate) to runner details (in Setup job logs)&lt;/li&gt;
&lt;li&gt;Increase frequency for spot interruption polling + add logs.&lt;/li&gt;
&lt;li&gt;Conform to AWS spec when sanitizing custom tags (key and value). Fixes #125.&lt;/li&gt;
&lt;li&gt;Add housekeeping task to handle edge cases where a job is still seen as queued by GitHub after a few minutes even after an instance has been launched.&lt;/li&gt;
&lt;li&gt;Allow to disable new housekeeping mechanism.&lt;/li&gt;
&lt;li&gt;Properly tag instance volumes with cost allocation tag. Cost report email will likely go up.&lt;/li&gt;
&lt;li&gt;Display &lt;code&gt;app_environment&lt;/code&gt; and &lt;code&gt;app_stack_name&lt;/code&gt; in logs.&lt;/li&gt;
&lt;li&gt;Attempt to fix rare preinstall issue ending up with "text file busy".&lt;/li&gt;
&lt;li&gt;Unregister runner from GitHub when job is completed (i.e. do not wait for auto-expiration since it does not seem that reliable).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Experimental&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Bring back support for single string label, using &lt;code&gt;/&lt;/code&gt; as the separator instead of &lt;code&gt;,&lt;/code&gt;. e.g. &lt;code&gt;runs-on: runs-on/runner=2cpu-linux-x64/other=tag&lt;/code&gt; will work. This simplifies passing a runs-on specification as input to dependent workflows. If you have multiple RunsOn stacks, make sure they are all upgraded to this version before using this new syntax in workflows.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Internal&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Fix issue with &lt;code&gt;private&lt;/code&gt; attribute not being properly loaded from the repository configuration file.&lt;/li&gt;
&lt;li&gt;Switch to semaphores for processing the 3 queues.&lt;/li&gt;
&lt;li&gt;Check workflow run status before scheduling job.&lt;/li&gt;
&lt;li&gt;Add termination queue.&lt;/li&gt;
&lt;li&gt;Update GitHub App (for new installations) to listen for workflow_run events (not used yet, but will be soon).&lt;/li&gt;
&lt;li&gt;Upgrade default runner version when no runner is preinstalled.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Upgrade notes&lt;/h2&gt;
&lt;p&gt;When upgrading from v2.5.0 or lower, due to the rolling restart mechanism, some jobs that were received by a process launched with this version might end up being processed by the old app version, in which case you might get errors like &lt;code&gt;json: cannot unmarshal string into Go struct field RunnerLabels.Labels.Private of type bool&lt;/code&gt; in your logs, and some runners may fail to launch. This is due to an internal structure change, and you simply need to cancel and retry those jobs once, or let the new housekeeping job reschedule them. After a few minutes the old app process will be gone and everything should work as expected.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://runs-on.com/guides/upgrade/"&gt;Upgrade Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CloudFormation Versioned template URL: https://runs-on.s3.eu-west-1.amazonaws.com/cloudformation/template-v2.5.4.yaml&lt;/li&gt;
&lt;/ul&gt;</content>
    <link href="https://github.com/runs-on/runs-on/releases/tag/v2.5.4" rel="alternate"/>
  </entry>
  <entry>
    <id>https://github.com/runs-on/runs-on/releases/tag/v2.5.5</id>
    <title>New release for RunsOn: v2.5.5</title>
    <updated>2024-10-16T13:04:54-04:00</updated>
    <author>
      <name>runs-on/runs-on</name>
    </author>
    <content>&lt;p&gt;Strengthen CF template configuration to better conform to AWS guidelines. Bug fixes.&lt;/p&gt;
&lt;h2&gt;What's changed&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Verify that generated JIT token has at least one char.&lt;/li&gt;
&lt;li&gt;Do not attempt to retry runner creation when we know the original request is invalid (e.g. invalid runner configuration due to mismatched labels etc.)&lt;/li&gt;
&lt;li&gt;Strengthen CF template configuration to better conform to AWS guidelines.&lt;/li&gt;
&lt;li&gt;Make sure empty admin values are ignored.&lt;/li&gt;
&lt;li&gt;If no repository config found, cache the result for 1 minute to avoid hammering GitHub API.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Upgrade&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://runs-on.com/guides/upgrade/"&gt;Upgrade Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CloudFormation Versioned template URL: https://runs-on.s3.eu-west-1.amazonaws.com/cloudformation/template-v2.5.5.yaml&lt;/li&gt;
&lt;/ul&gt;</content>
    <link href="https://github.com/runs-on/runs-on/releases/tag/v2.5.5" rel="alternate"/>
  </entry>
  <entry>
    <id>https://github.com/runs-on/runs-on/releases/tag/v2.5.6</id>
    <title>New release for RunsOn: v2.5.6</title>
    <updated>2024-10-18T04:47:12-04:00</updated>
    <author>
      <name>runs-on/runs-on</name>
    </author>
    <content>&lt;p&gt;Enable IPv6 for runners. Allow to specify multiple static IPs for the managed NAT gateway. Allow filtering images based on tags. A lot of changes (again) around GitHub rate-limit handling and housekeeping mechanism.&lt;/p&gt;
&lt;h2&gt;New features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Enable IPv6 for runners (fixes #142). An IPv6 is attached for both public and private runners, with an egress ipv6 (free) gateway for private instances.&lt;/li&gt;
&lt;li&gt;Allow to specify multiple static IPs for the managed NAT gateway (fixes #139). By default up to 2 are possible, and up to 8 when a quota increase is requested. This helps if you are launching a large number of runners in private subnets, and some external service rate-limits you based on the IP.&lt;/li&gt;
&lt;li&gt;Allow filtering images based on a tag, in addition to the name wildcard (e.g. &lt;code&gt;is-production-ready=true&lt;/code&gt;). Example :&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;```yaml&lt;/p&gt;
&lt;h1&gt;.github/runs-on.yml&lt;/h1&gt;
&lt;p&gt;images:
  custom:
    owner: "123456789"
    name: "my-org/my-image-name-&lt;em&gt;"
    arch: x64
    platform: linux
    tags:
      # filter with specific value
      is-production-ready: "true"
      # allow any value
      other-tag: "&lt;/em&gt;"
&lt;code&gt;``
- Automatically bind-mount&lt;/code&gt;/var/lib/docker` on the ephemeral instance storage, if any. Fixes #144.&lt;/p&gt;
&lt;h2&gt;Bug fixes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Escape shell special characters in env file values.&lt;/li&gt;
&lt;li&gt;If a matching AMI cannot be found, do not retry and alert on first error.&lt;/li&gt;
&lt;li&gt;Do not attempt to retry job if generated fleet params configuration is incorrect.&lt;/li&gt;
&lt;li&gt;Abort early if workflow run status cannot be checked.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Fixes to avoid GitHub rate-limit issues&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;No longer attempt to reschedule jobs where a runner theft is suspected. Instead log a warning message telling users to make sure their jobs &lt;a href="https://runs-on.com/guides/troubleshoot/#long-queuing-time-for-some-workflows"&gt;have unique enough labels&lt;/a&gt;. In some cases this was triggering useless reschedules due to GitHub not reflecting the job state quickly enough.&lt;/li&gt;
&lt;li&gt;Fix too many GitHub calls when fetching repo config from an &lt;code&gt;extends&lt;/code&gt; attribute (cache it).&lt;/li&gt;
&lt;li&gt;No longer unregister runners from GitHub if API credit is lower than 2500. They will be &lt;a href="https://github.blog/changelog/2022-08-03-github-actions-remove-offline-self-hosted-runners/"&gt;removed by GitHub&lt;/a&gt; 24h later anyway.&lt;/li&gt;
&lt;li&gt;Reorganize rate-limiters, increase &lt;code&gt;DELAY_SECONDS_FOR_CHECK_BACK&lt;/code&gt; to 180s instead of 120s. Enable github rate-limiter, and set burst to the current number of remaining tokens.&lt;/li&gt;
&lt;li&gt;Only attempt to finalize a job once at most. Instance will auto-terminate anyway so at worst we lose the job usage metrics in CloudWatch. But at least we don't eat into the GitHub / EC2 credits.&lt;/li&gt;
&lt;li&gt;Set housekeeping and termination queue sizes to 1 to reduce their impact on GitHub API credits.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Upgrade&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://runs-on.com/guides/upgrade/"&gt;Upgrade Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CloudFormation Versioned template URL: https://runs-on.s3.eu-west-1.amazonaws.com/cloudformation/template-v2.5.6.yaml&lt;/li&gt;
&lt;/ul&gt;</content>
    <link href="https://github.com/runs-on/runs-on/releases/tag/v2.5.6" rel="alternate"/>
  </entry>
</feed>
